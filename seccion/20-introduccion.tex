% !TeX root = ../tfm.tex
%! TEX root = ../tfm.tex
\iffalse
Resumen esquemático de cada una de las partes del trabajo. Leer esta sección ha de dar una idea clara de lo que se pretendía y las conclusiones a las que se han llegado y del proceso seguido. Es uno de los capítulos mas importantes

Motivación:
Problema a tratar, posibles causas, relevancia del problema

Planteamiento:
¿cómo se puede resolver el problema qué se propone descripción de objetivos en términos generales?

Estructura:
qué hay en cada uno de los subsiguientes capítulos
\fi

\section{Motivación}\label{sec:intro:motivación}

En un momento en el que la población mundial acelera su crecimiento se da la paradoja de que que en la gran parte de las sociedades occidentales su población envejece rápidamente. Este envejecimiento es consecuencia de la continua tendencia descendente de la tasa de fertilidad pero sobretodo por el incremento en la esperanza de vida de la población. Este aumento en la longevidad de la población no implica que sea más saludable, más bien al contrario al aumentar la proporción de gente mayor.

En su página web, la Organización Mundial de la Salud recoge que los mayores de 65 años son los más propensos a sufrir caídas, y que se producen aproximadamente 37 millones de caídas que requieren atención médica y recomienda priorizar la investigación relacionada con las caídas\cite{FactsFalls2018}. En este contexto es normal que proliferen estudios y soluciones para mejorar la atención de estos colectivos de riesgo.

Esta tendencia no es nueva, el estudio e implementación de sistemas para la detección de caídas lleva décadas en desarrollo\cite{fallindex00, Chen2005, Noury2007, Bourke2006}. Estos métodos basados en el análisis de la cinemática y posición del cuerpo si bien extremadamente eficientes han sido remplazados por más complejos modelos basados en modelos de aprendizaje automático \cite{Ozdemir2014,Aziz2017b,Putra2017}. En la actualidad se comercializan multitud de dispositivos para la detección de caídas de muy variada índole: desde sistemas de propósito específico como las alarmas de detección de caídas en el baño basadas en una correa atada a la muñeca, a sistemas multipropósito (basados en dispositivos de captura y otro de procesado por separado), pasando por productos que usan complejos métodos de captura y procesado de imágenes. Todos estos sistemas adolecen o bien de restricciones geográficas (su funcionamiento queda limitado a un entorno acotado por el alcance de las cámaras o cobertura del enlace radio con la base de procesado) o bien resultan poco prácticos, e incluso invasivos para un grupo de usuarios que no está acostumbrado a lidiar con la tecnología.

\section{Planteamiento del trabajo}\label{sec:intro:planteamiento}

La rápida evolución tecnológica permite tener a nuestra disposición cada vez más dispositivos \textit{vestibles} (por \textit{wearables} del inglés, dispositivos electrónicos compuestos por sesores y procesadores que se incorporan en alguna parte del cuerpo) con capacidad de conectarse a Internet. Estos dispositivos mejoran generación tras generación gracias a la creciente capacidad de cálculo de los microprocesadores, la miniaturización de los sensores y la reducción de costes, lo que ha permitido generalizar, extender y popularizar su uso al grueso de la sociedad. Estos avances se aprovechan ya en algunas soluciones al problema de la detección de caídas. Se utilizan los datos capturados por acelerómetros triaxiales y/o sistemas inerciales de una pulsera de actividad o reloj inteligente ya sea para realizar un procesado analítico de los parámetros medidos y realizar la detección de una caída. Por ejemplo, en trabajos \cite{fallindex00, Chen2005,Bourke2006,Kangas2008,Bagala2012} que buscan una aceleración fuerte y abrupta,  o bien en sistemas más complejos \cite{Luque2014,Vilarinho2015} para enviar este flujo de datos a un segundo sistema para realizar la detección mediante modelos complejos con grandes requisitos computacionales\cite{Cho2014, Aziz2017b,Putra2017}. Ambas soluciones tienen sus beneficios y contraprestaciones. La primera tiene a su favor la simplicidad y alta disponibilidad al aunar captura y tratamiento en la misma unidad, pero falla al usar algoritmos poco precisos, al contrario que la segunda opción que se aprovecha de la mayor potencia de un segundo centro de cómputo para mejorar la detección a costa de una mayor complejidad en el sistema que impacta negativamente en su facilidad de uso y disponibilidad. Hay que tener en cuenta que el público objetivo de esta tecnología es un segmento de población con escasos conocimientos de nuevas tecnologías y poco habituado a su uso diario.

Este trabajo propone una solución, \ifell/ simple de usar, no invasiva y que al mismo tiempo ofrezca resultados comparables al estado del arte. Para conseguir estos objetivos aprovecharemos la mejora en rendimiento y consumo de los microprocesadores de sistemas llevables (como pueden ser las pulseras de actividad o los relojes inteligentes), para el tratamiento y predicción de series temporales en un sistema que realiza la captura, tratamiento y detección de caídas en la misma unidad usando algoritmos de aprendizaje automático. Esta es la principal diferencia con los sistemas ya existentes: usar un algoritmo basado en los últimos avances en tecnologías de predicción temporal con inteligencia artificial, redes recurrentes GRU (\textit{Gated Recurrent Unit}, un tipo de celda para formar redes neuronales recurrentes),  y un mecanismos de atención o eventos para reducir los requisitos de capacidad de cómputo y mejorar la autonomía. Este trabajo aporta al campo de la detección de caídas la novedad de usar la arquitectura codificador-decodificador con redes neuronales recurrentes para conseguir una una secuencia de predicción en un único paso. Esta secuencia generada mediante la extracción de características y posterior reconversión en una serie temporal realizada por las redes de codificación y decodificación, permite mediante un comparador realizar una detección de anomalías. Comparando esta señal de salida con la señal real demostraremos que dada la baja capacidad de generalización de las redes neuronales para interpretar casos no entrenados (anomalías o caídas en nuestro caso) es posible discriminar las caídas. Este sistema permite simplificar el clasificador a un único caso: ser una \textit{actividad} o no serlo (\textit{anomalía}).

Estas tres mejoras (detección en dos etapas, predicción de varios pasos a la vez y simplificación del clasificador) permiten ejecutar el sistema con una latencia baja en un sistema discreto, no invasivo o molesto para el usuario final, como es llevar puesto un reloj de pulsera. El objetivo final es implementar una solución para la detección de caídas con gran precisión, mejor que la de los sistemas analíticos y próxima a la del estado del arte de los sistemas basados en aprendizaje automático que se ejecute exclusivamente en un dispositivo llevable.

\section{Estructura de la memoria}\label{sec:intro:estructura}

Los capítulos que estructuran este documento se organizan de la siguiente forma: en el \fullref{chap:stateofart}, realizamos una introducción y revisión del del estado del arte y literatura relacionada con la problemática abordada. Haremos especial hincapié en el tratamiento de la actividad humana (\autoref{sec:arte:detección_caídas}, y los diferentes acercamientos existentes para aboradar la detección de caídas en las Secciones \ref{sec:arte:modelos_analiticos}, \ref{sec:arte:modelos_ml} y \ref{sec:arte:modelos_hybridos} ya que en los siguientes capítulos haremos muchas referencias a estos trabajos. Habiendo establecido las bases de la situación actual de la tecnología y soluciones disponibles presentaremos el objetivo a abordar por la aplicación y una serie de metas previas e intermedias que faciliten la evaluación de los logros conseguidos en el \fullref{chap:objetivos}.

Antes de presentar el desarrollo propio de este trabajo introduciremos componentes (\ref{sub:req:hardware}, plataformas (\ref{sec:req:plataforma}), entornos (\ref{sec:req:tflite}), bases de datos (\ref{sec:req:bases:datos}) y modelos de detección (\ref{sec:req:modelos}) ya existentes sobre las que basaremos esta implementación, su necesidad, sus limitaciones y posibles alternativas, justificando siempre las decisiones en base al cumplimiento de los objetivos previamente descritos. Acto seguido nos adentraremos en el desarrollo e implementación de la solución en el \fullref{chap:generar:dataset} y \fullref{chap:desarrollo:algoritmo}. En esta parte detallaremos el trabajo realizado, el sistema, las diferentes aplicaciones que lo componen, sus arquitecturas así como detalles del modelo utilizado, sus parámetros y funcionamiento.

Una vez explicado todo el proceso seguido para implementar toda la plataforma pasaremos a evaluar el sistema en el \fullref{chap:eval}. Analizaremos los resultados obtenidos en cada una de las etapas de desarrollo, ajustaremos los diferentes parámetros, compararemos con otras soluciones existentes y justificaremos las decisiones tomadas con dichos datos. Volveremos a revisar de forma más frugal estos resultados en el \fullref{chap:conclusiones} para exponer las conclusiones obtenidas y presentar posibles líneas de trabajo futuro que por diversas razones no se han podido explorar. Al final en los apéndices detallaremos otros aspectos como las bases de datos usadas (\fullref{app:dataset}), la plataforma llevable usada (\fullref{app:plataforma}) y listaremos algunos fragmentos de código de la implementación relevantes en esta memoria (\fullref{app:codigo}).\todo{Añadir apéndices si se actualizan y punto}

