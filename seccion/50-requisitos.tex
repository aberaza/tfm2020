\documentclass[../tfm.tex]{subfiles}
\begin{document}
\info{Indicar el trabajo previo realizado para guiar el desarrollo del software.
Debe identificar adecuadamente el problema a tratar, contexto adecuado de uso y funcionamiento de la aplicación. Idealmente se debería realizar con expertos en la materia a tratar.}

Para la realización de este trabajo es necesario conseguir aunar y definir tres componentes.
\begin{itemize}
  \item Dispositivo de captura de actividad y procesado
  \item Conjunto de datos para entrenamiento y validación
  \item Modelo de detección de caídas
\end{itemize}

\section{Dispositivo}\label{req_hardware}

La evolución en sensores y microprocesadores han conseguido popularizar en los últimos años infinidad de sistemas embebidos para capturar y medir nuestros niveles de actividad. Publicitados como sistemas para controlar nuestra actividad física, han ido evolucionando de simples podómetros a complejos sistemas de captura inercial, constantes vitales y posición con acceso a internet. Debemos distinguir entre dos familias de dipsotivos \textit{wearables}, o \textit{vestibles}: Aquellos que simplemente realizan la captura de datos y delegan el cómputo en otro dispositivo (siendo los más conocidos miembros de esta familia las pulseras de actividad), y las plataformas que aunan captura y tratamiento en el mismo sistema, aunque puedan a su vez transmitir los datos a un tercer actor (como por ejemplo los \textit{smartwatches}). Estos últimos dispositivos son efectivamente microcomputadoras miniaturizadas al extremo.

Con el fin de obtener un sistema complétamente autónomo y lo menos obtrusivo posible \todo{citar o referenciar el punto posterior de evaluación del sistema donde se explica que los requisitos para un sistema de caidas pensado para gente mayor ha de ser facil de usar y lo más cotidiano posinle, ejemplo un reloj.} optamos por utilizar un reloj inteligente. Existen al menos 4 grandes familias de estos dispositivos:

\warn{Nota de la profe: Indica que deberñia tratar los requisitos para la solución, no para eldispositivo. (quizás compartimerntar diferente esta sección? Indica poner primero los requisitos  luego ir viendo cuales lo cumplen.)
}

\begin{itemize}
  \item{Apple Wath}
  \item{Android Watch o WearOS}
  \item{Samsung Smartwatch o TizenOS}
  \item{Huawei Smartwatch}
\end{itemize}

De todas estas familias, podemos descartar rápidamente Huawei, por no ofrecer un kit de desarrollo de aplicaciones, así como la plataforma Apple por el excesivo precio de esta. Existen en el mercado soluciones específicas que no justificarían el desembolso.

Tanto WearOS como TizenOS ofrecen potentes herramientas de desarrollo así como detallada documentación. Soportan ambas modelos de inteligencia artificial desarrollados con TensorFlow Lite y los dispositivos que los usan equipan microprocesadores con capacidades siimilares. Optamos por desarrollar en prototipo para la plataforma WearOS por tener un concepto abierto de implementacion del hardware y poder disponer por tanto de mayor variedad de dispositivos. Sin embargo dado que ambos pueden trabajar con los modelos que generaremos, portar la funcionalidad de una plataforma a otra debería ser trivial. El dispositivo elegido es un Fossil Sport Gen3 del que podemos encontrar más información en la sección \ref{app:fossil}.


\section{Base de datos de actividad}\label{req_base de datos}
Tras un análisis de los diferentes conjuntos de datos disponibles y estudiar cuan bien se adaptaban a los requisitos del sistema, concluimos que ninguno cubre el 100\% de los requisitos. Así pues decidimos optar por un enfoque modular y dividir el estudio en dos bloques: Validación e Implementación.

Como validación entendemos el estudio del modelo propuesto y su viabilidad y eficacia para la tarea. Así pues buscaremos un base de datos etiquetado con un rango de valores que puedan ser adaptados a los límites impuestos por la plataforma elegida o sean de magnitud comparable sin enfocarnos en si los dispositivos de captura eran similares o su localización es la misma que en este trabajo. Así mismo nos interesa que sea un base de datos extendido entre la comunidad investigadora para poder comparar los resultados con los obtenidos en este trabajo y poder determinar si el modelo es válido para la tarea.

En la etapa de implementación usaremos un base de datos específico para nuestro sistema y que se desarrolló durante la ejecución del trabajo. Este base de datos es el utilizado para entrenar el modelo final.

\subsection{Base de Datos para la validación}
\todo{redacción y citas y referencias y quitar palabras ambiguas como muchas, otras, etc.}
SisFALL (Tras considerar otros muchos como umafall, mobiact/mobifall, etc): mayor cantidad de caídas y muchas de las actividades son consideradas \textit{quasi-caidas} y por tanto son casos límite. Si el modelo es capaz de dar buenos resultados en estas condiciones, es un buen modelo. Además, es usado por \cite{Musci2020} y varios de los estudios presentes en \cite{Anita2020} por lo que resulta ideal para comparar los resultados.

\subsection{Base de Datos para la implementación}

Para poder generar un modelo con el mismo tipo de datos y capturado de la misma forma a los que deberá procesar posteriormente, optamos por realizar un base de datos de datos propio usando el mismo dispositivo sobre el que se ejecutará el prototipo como plataforma de captura.

Este base de datos se realiza usando únicamente información del sensor de aceleración triaxial del reloj Fossil Sport Gen3 \ref{app:fossil} a una frecuencia de muestreo de 50Hz. Los valores de aceleración medidos están expresados en $m/s^2$ dentro de los límites de la plataforma. Este es un base de datos no etiquetado dado que el objetivo es entrenar un modelo de predicción de series temporales y no un clasificador como suele ser habitual.

Para generar las capturas de los acelerómetros se implementa la aplicación \textit{AccelCapture} \ref{app:accelcapture}. En el apéndice \ref{app:dataset} se encuentra una descripción del proceso de generación y especificaciones detalladas del base de datos generado.
\todo{no ponerlo como apéndice, es parte importante, ponerlo aquí (referenciar ciertas cosas al apéndice que sean de menor interés)}

A la hora de parametrizar el sistema de captura de datos, optamos por mantener los 50Hz de frecuencia de muestreo. \cite{Liu2018} demuestra que se pueden conseguir buenos modelos basados en aprendizaje automático con tan solo 5,8Hz, aunque generaliza en 21,3Hz la frecuencia de muestreo mínima necesaria. Nos mantenemos por encima de este límite para eliminar una posible fuente de errores en el modelo.

\section{Modelo}\label{req_modelos}

\todo{nada de vaguedades, qué modelos, cuales voy a usar, qué valores he calculado yo y cuales vienen de fuera}
Estudios similares han mostrado la mayor capacidad de los sistemas basados en aprendizaje automático. Sin embargo estos algoritmos no han conseguido desplazar en los sistemas comerciales a los métodos analíticos por la gran capacidad de cálculo que requieren. Algunos trabajos han demostrado la eficacia de hibridar los modelos usando un modelo computacionalmente simple para raealizar una tarea de detección de candidatos a caídas de fondo y un modelo complejo que actúe únicamente sobre este subconjunto de episodios. Este es el acercamiento que toma este trabajo.

\subsection{Modelos Analíticos}
\warn{Básicamente miden aceleración y actitud del cuerpo. Para este trabajo usaremos únicamente los modelos que trabajen con aceleración, los más simles. Nos quedamos con Bourke. Explicar brevemente principio, pq Bourque y los resultados obtenidos de bourke con sisfall en otros estudios y en el nuestro}

\paragraph{Bourke:} Los modelos de Bourke \cite{Bourke2006} se basan en la detección de la estructura típica del vector suma de la aceleración de una caída. Esta estructura está compuesta por un valle seguido de un pico. El valle está asociado al inicio de la caída, momento en el que se contrarresta la aceleración constante de 1G en sentido vertical al que están expuestos los cuerpos con la aceleración en el mismo sentido del cuerpo en caída. El posterior pico es debido a las aceleraciones durante el impacto con el suelo. Así pues Bourke propone establecer dos cotas, una para detectar el valle y otra el pico. Con estas cotas definidas se pueden extraer tres modelos. Uno que observe los picos, otro los valles y un tercero que obseerve valles y picos.
\figura{BourkeLowThresholdsHistogram}{fig:bourke_low_hist}{Histograma valores \textit{valle} modelo Bourke}
\figura{BourkeUpperThresholdsHistogram}{fig:bourke_upper_hist}{Histograma valores \textit{pico} modelo Bourke}
Para establecer las cotas, Bourke propone analizar un base de datos de caídas y establecer los niveles de tal forma que el 100\% de las caídas entren dentro del espacio, consiguiendo una sensibilidad del mismo valor por definición. Este modelo tiene la desventaja de tener una especificidad muy baja. Los resultados con el dataset SisFall nos arrojan un valor para las cotas de 0,971G para el valle y 4,164G para el pico. Con estos valores se consigue una especificidad de tan solo $0,9\%$. Si observamos la distribución de los valores de valle de las caídas y resto de actividades en la figura \ref{fig:bourke_low_hist}, se aprecia el alto grado de solapamiento y como pràcticamente todos los supuestos del dataset entran dentro del conjunto seguregado por el modelo. Por contra, el análisis de los valores de pico (figura \ref{fig:bourke_upper_hist}) arroja una dsitribucion que permite obtener un discriminador de mejor calidad.

\warn{TODOS LOS RESULTADOS QUE CALCULE YO HAN DE IR EN EL APARTADO DESARROLLO!!!}

Efectivamente en la figura \ref{fig:bourke_cfmatrix} se aprecia como usando únicamente la cota superior o del pico el modelo de bourke alcanza una especificidad del 42,84\% que aumenta hasta el 64\% si aceptamos una degradación de la sensibilidad hasta el 87,8\%.

\figura{BourkeCONF_Matrix}{fig:bourke_cfmatrix}{Matrices de confusión para modelos Bourke}
\subsection{Modelos Basados en Aprendizaje Automático}
\warn{Mirada de estudios. Enfocarse en los que usar wearables y aceleración. Sistemas SVN, K-Means y RNN. Analizar los resultados usados con modelo Stateless Bidirectional GRU 1 capa 40 unidades. Comparar con los resultados de otros estudios}

\subsection{Modelos Híbridos}
\warn{este es el trabajo a realizar. Introducir los trabajos de ..... y poco más}

\section{TensorFlow Lite} \label{req_tflite}
Opciones y limitaciones que impone el framework a introducir aquí



\warn{RECOMENDACIÓN: ponerlo en su sección (capítulo 4), aunque es únicamente una sugerencia. Podemos quizás dejarlo y poner algo similar en cada capítulo.} Estos conceptos se retoman posteriormente para definir los prerrequisitos: plataforma de desarrollo \ref{req_hardware} como herramientas de software \ref{req_tflite} y conjuntos de datos adecuados para entrenamiento y validación de resultados \ref{req_base de datos}. Trataremos la situación actual y soluciones disponibles así como las limitaciones y sus posibles soluciones. Trataremos de nuevo el problema de los diferentes tipos de modelos de detección de caídas \ref{req_modelos} relacionando sus capacidades con las limitaciones tanto de los conjuntos de datos como del soporte físico y computacional usado y su adecuación a la solución propuesta.

\end{document}

